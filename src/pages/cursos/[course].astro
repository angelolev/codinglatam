---
import { getEntry } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import figmaLogo from "../../../public/figma.svg";
import linkedinLogo from "../../../public/linkedin.svg";
import calendarImage from "../../../public/calendar.svg";
import { Image } from "astro:assets";
import Link from "../../components/Link.astro";
import FAQ from "../../components/FAQ.astro";

export function getStaticPaths() {
  return [{ params: { course: "react" } }];
}

const { course } = Astro.params;
const courseData = await getEntry("courses", course);

if (!courseData) {
  throw new Error("Course not found");
}

const {
  title,
  description,
  startDate,
  figmaLink,
  buyLink,
  faqs,
  topics,
  instructor,
  project,
} = courseData.data;

const dateObj = new Date(startDate);

const formattedDate = dateObj.toLocaleDateString("es-PE", {
  day: "2-digit",
  month: "long",
  year: "numeric",
});
---

<Layout title=`Curso: ${title} | Coding Latam`>
  <header
    class={`bg-sky-500 bg-hero-${course} h-96 bg-cover bg-center relative flex items-center`}
  >
    <div class="absolute inset-0 bg-gray-800 opacity-50"></div>
    <div class="content max-w-6xl lg:mx-auto px-4 relative z-10 w-full">
      <h1 class="text-white mb-6">{title}</h1>
      <p class="max-w-2xl font-semibold text-lg mb-4">
        {description}
      </p>
      <div class="dates flex gap-4 items-center mb-4">
        <Image class="max-w-10" src={calendarImage} alt="Calendar" />
        <p class="text-base">Inicio: {formattedDate}</p>
      </div>

      <Link href={buyLink} variant="fill"> Reservar mi lugar </Link>
    </div>
  </header>

  <main class="relative">
    <section class="topics max-w-6xl mx-auto px-4 py-16">
      <h2>Temario</h2>
      <ul class="list-disc pl-5 flex flex-col gap-4">
        {topics?.map((item) => <li>{item.title}</li>)}
      </ul>
    </section>
    <section
      class="py-8 instructor md:absolute right-0 lg:right-[10%] top-0 text-center max-w-6xl mx-auto px-4 md:py-0 md:pt-16"
    >
      <p class="text-base mb-6">Aprende con:</p>
      <div
        class="content flex justify-center items-center gap-4 flex-wrap max-w-80"
      >
        <Image
          class="rounded-full"
          src={instructor.picture}
          alt={instructor.name}
          width={150}
          height={150}
        />
        <div class="name flex gap-2 items-center">
          <h3 class="text-primary-300">{instructor.name}</h3>
          <Link href={instructor.linkedin} variant="none">
            <Image class="max-w-6" src={linkedinLogo} alt="Linkedin" />
          </Link>
        </div>

        <p>{instructor.role}</p>
      </div>
    </section>
    <section class="project bg-black-border py-16">
      <div class="content max-w-6xl mx-auto px-4">
        <h2>
          Proyecto a desarrollar: <span class="text-white">{project.name}</span>
        </h2>
        <div class="figma flex gap-2 items-center my-6">
          <Image class="max-w-10" src={figmaLogo} alt="Figma" />
          <a
            target="_blank"
            class="underline underline-offset-4"
            href={figmaLink}>Figma del proyecto</a
          >
        </div>
        <ul class="list-disc pl-5 flex flex-col gap-4">
          {project.topics.map((item) => <li>{item}</li>)}
        </ul>
      </div>
    </section>
    <section class="instructor-detail py-16 my-10">
      <div class="content max-w-6xl mx-auto px-4">
        <h2>Conoce a <span class="text-white">{instructor.name}!</span></h2>
        <div class="mt-4" set:html={instructor.description} />
      </div>
    </section>
    <section class="faqs py-16 bg-black-border">
      <div class="content max-w-6xl mx-auto px-4">
        <h2 class="my-6 text-primary-300">Preguntas frecuentes</h2>
        {faqs?.map((item) => <FAQ {...item} />)}
      </div>
    </section>
    <section
      class="py-16 text-center grid grid-cols-1 gap-6 max-w-6xl mx-auto px-4"
    >
      <h3 class="leading-8">
        Sesiones <span class="text-primary-300">EN VIVO</span> + horas extras de
        preguntas y respuestas
      </h3>
      <h3 class="leading-8">
        Aprender√°s <span class="text-primary-300">HACIENDO</span>
      </h3>
      <h3 class="leading-8">
        Proyectos que puedes agregar a tu <span class="text-primary-300"
          >PORTAFOLIO</span
        >
      </h3>
      <div class="action mx-auto mt-12">
        <Link href={buyLink} variant="fill">Comprar ahora</Link>
      </div>
    </section>
  </main>
</Layout>
<style>
  h2 {
    @apply text-primary-300 my-6;
  }
</style>
